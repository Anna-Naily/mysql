-- Определить кто больше поставил лайков (всего) - мужчины или женщины?
-- Прошлая версия
SELECT COUNT(*) AS likes, gender FROM likes, profiles
WHERE likes.user_id = profiles.user_id
GROUP BY gender;

-- Версия с JOIN
SELECT COUNT(*) AS likes, gender FROM profiles JOIN likes
ON profiles.user_id = likes.user_id
GROUP BY gender;
 
   
-- Подсчитать общее количество лайков десяти самым молодым пользователям (сколько лайков получили 10 самых молодых пользователей).

-- Прошлая версия
SELECT COUNT(*) FROM likes 
  WHERE target_type = 'users'
    AND target_id IN (SELECT * FROM (
      SELECT user_id FROM profiles ORDER BY birthday DESC LIMIT 10
    ) AS sorted_profiles );
   
-- версия с JOIN
SELECT COUNT(*)/100 AS result_ FROM likes JOIN profiles
 ON target_type = 'users'
 AND likes.target_id IN (SELECT * FROM (SELECT user_id FROM profiles
 ORDER BY birthday DESC LIMIT 10) AS sort);
